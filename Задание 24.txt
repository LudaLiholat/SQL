Пример:

Найдите максимальную цену ПК для каждого производителя, модели которого есть в таблице ПК.
Результат: производитель, максимальная цена.


Решение:

WITH MAX_PRICE AS(
    SELECT MAX(SQ.price) AS 'price'
    FROM (
        SELECT price FROM pc
        UNION
        SELECT price FROM laptop
        UNION
        SELECT price FROM printer) AS SQ)

SELECT SQ1.model
FROM (
    SELECT model, price
    FROM pc
    UNION
    SELECT model, price
    FROM laptop
    UNION
    SELECT model, price
    FROM printer
) SQ1
INNER JOIN MAX_PRICE SQ2 ON SQ1.price = SQ2.price
